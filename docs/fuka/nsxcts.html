<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FUKA: Neutron Star</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<!-- <script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
</script> -->
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FUKA
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('nsxcts.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Neutron Star </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md85"></a>
Neutron Star (NS) Initial Data</h1>
<h1><a class="anchor" id="autotoc_md86"></a>
1. Overview</h1>
<p>The isolated NS code was created to test many aspects of the initial data creation such as formalism implementation, initial guess generation, and import into an evolution framework. It has now become a critical piece in generating binary ID that include a NS companion. The codes included here are simply the means for a user to generate an isolated NS and analyze it. <br  />
 This is an excellent way for a new user to get acquainted with how the FUKAv2 solvers work with ID that requires an EOS.</p>
<h1><a class="anchor" id="autotoc_md87"></a>
2. Organization</h1>
<ol type="1">
<li><code>CMakeLists.txt</code> is the file needed by CMake to compile the codes</li>
<li><code>compile</code> is a symbolic link to the script stored in <code>$HOME_KADATH/build_release</code> to ease compiling</li>
<li><code>src</code> directory contains the relevant source files:<ul>
<li><code>solve.cpp</code>: the one and done solve code</li>
<li><code>reader.cpp</code>: the reader can provide diagnostics from ID solutions that are computed from the ID</li>
</ul>
</li>
</ol>
<h1><a class="anchor" id="autotoc_md88"></a>
3. Base Usage</h1>
<ol type="1">
<li>Generate the initial config file by running <code>solve</code> for the first time</li>
<li>Modify the initial config file based on ID characteristics you are interested in</li>
<li>Rerun (using parallelization) using this config file, e.g. <code>mpirun ./bin/Release/solve initial_ns.info</code></li>
</ol>
<h1><a class="anchor" id="autotoc_md89"></a>
4. Your first run!</h1>
<ol type="1">
<li>Generate the initial config file by running <code>solve</code> for the first time</li>
<li>Rerun (using parallelization) using this config file, e.g. <code>mpirun ./bin/Release/solve initial_ns.info</code></li>
<li>This will result in the generation of a pair of files containing the solution: <code>NS_TOTAL_BC.togashi.1.4.0.0.09.&lt;info/dat&gt;</code></li>
</ol>
<p>We can deconstruct the name to make it understandable:</p>
<ul>
<li><code>NS_TOTAL_BC.</code> denotes a converged NS solution after the TOTAL_BC stage. This is meant to distinguish the solution from other stages such as the NOROT_BC and boosted NS stage. This also distinguishes it from checkpoints that can be turned on which our saved to file during each iteration of the solver</li>
<li><code>togashi</code> denotes the eosfile used in the ID construction</li>
<li><code>1.4.0.</code>: In this case, we have a 1.4M NS with a dimensionless spin of zero</li>
<li><code>0.09.</code>: the number of <em>additional</em> spherical <code>nshells</code> is <code>0</code> and the resolution in each domain is <code>9</code> collocation points in the radial and theta direction with <code>8</code> points in the phi direction</li>
<li><code>info</code>: The info file contains all the steering parameters, values used in creating the domain decomposition, EOS parameters, stored fields, stages, settings, and controls</li>
<li><code>dat</code>: The dat file is a binary file that contains the numerical space and the variable fields</li>
</ul>
<p>The default configuration for an isolated NS has a mass of 1.4M and non-spinning. Aside from the diagnostics observed during the solver stage, we can use the reader to verify the ID. This can be done by running:</p>
<p><code>./bin/Release/reader NS_TOTAL_BC.togashi.1.4.0.0.09.info</code></p>
<p>Which results in the following:</p>
<div class="fragment"><div class="line">                   RES = [+9,+9,+8]</div>
<div class="line">            Coord R_IN = +3.03469</div>
<div class="line">               Coord R = [+6.33309, +6.33309]</div>
<div class="line">           Coord R_OUT = +12.13876</div>
<div class="line"> </div>
<div class="line">               Areal R = +7.81046 [+11.53605km]</div>
<div class="line">         Baryonic Mass = +1.55255</div>
<div class="line">              ADM Mass = +1.40000 [+1.40000]</div>
<div class="line">          ADM Momentum = +0.00000</div>
<div class="line">                   Chi = +0.00000 [+0.00000]</div>
<div class="line">                 Omega = +0.00000</div>
<div class="line">       Central Density = +1.37405e-03</div>
<div class="line">        Central log(h) = +2.31726e-01</div>
<div class="line">      Central Pressure = +2.34280e-04</div>
<div class="line">    Central dlog(h)/dx = +3.40893e-14</div>
<div class="line">Central Euler Constant = -2.22137e-01</div>
<div class="line">     Integrated log(h) = +186.08372</div>
<div class="line"> </div>
<div class="line">                    Mk = +1.40096, Diff: +6.84955e-04</div>
<div class="line">                    Px = +0.00000</div>
<div class="line">                    Py = +0.00000</div>
<div class="line">                    Pz = +0.00000</div>
</div><!-- fragment --><p>The first block contains information related to the numerical space specifically the</p>
<ul>
<li>resolution <code>[r,theta,phi]</code></li>
<li>the fixed coordinate radii related to the nucleus</li>
<li>the extremal coordinate radii along the adaptive surface</li>
<li>the fixed coordinate radii related to the spherical boundaries outside the stellar surface</li>
</ul>
<p>The second block includes the</p>
<ul>
<li>proper radius of the NS as measured on the stellar surface</li>
<li>total baryonic mass</li>
<li>ADM mass</li>
<li>ADM spin angular momentum</li>
<li><code>chi</code> the dimensionless spin parameter</li>
<li>variable spin frequency <code>omega</code></li>
<li>Central density</li>
<li>Central log specific enthalpy <code>h</code></li>
<li>Central pressure</li>
<li>Central dlog(h)/dx</li>
<li>Euler constant at the steller center</li>
<li>Integral of log specific enthalpy over the whole NS</li>
</ul>
<p>Finally, the third block includes</p>
<ul>
<li>Komar mass</li>
<li>ADM linear momenta <code>P&lt;x,y,z&gt;</code></li>
</ul>
<p><b> Note:</b></p>
<p><b></p><ol type="1">
<li>In all blocks, brackets denote the values stored in the config file that the solution was fixed by</li>
<li>The <code>Diff</code> noted by the Komar mass is the symmetric difference between the ADM and Komar mass.</li>
</ol>
<p></b></p>
<p><b></b></p>
<h1><a class="anchor" id="autotoc_md90"></a>
5. Understanding the NS INFO file</h1>
<p>Using your favorite text editor, you can open up the <code>initial_ns.info</code>. We will go through the file, but we'll discuss only the details relevant to the NS case. For details on all the parameters you can see more in <a href="https://bitbucket.org/fukaws/fuka/src/fuka/include/Configurator/">Configurator README</a>.</p>
<p><b> Notes:</b></p>
<p><b></p><ol type="1">
<li>It is always best practice to generate new ID using the <code>initial_ns.info</code>. Using old initial data unless for very small changes in <code>chi</code> is inefficient.</li>
<li>In FUKAv2.2 a minimal Config file was introduced such that only the basic fixing parameters most relevant to users are shown. This minimal Config file can be bypassed by running: <pre class="fragment">solve full
</pre> to obtain the full Config file. Although useful for development, there is little advantage to using the full Config.</li>
</ol>
<p></b></p>
<p><b></b></p>
<h2><a class="anchor" id="autotoc_md91"></a>
NS Fixing parameters</h2>
<div class="fragment"><div class="line">ns</div>
<div class="line">{</div>
<div class="line">    chi 0</div>
<div class="line">    madm 1.3999999999999999</div>
<div class="line">    res 9</div>
<div class="line">    eosfile togashi.lorene</div>
<div class="line">    eostype Cold_Table</div>
<div class="line">}</div>
</div><!-- fragment --><p>The above includes parameters that can be fixed by the user as well as parameters that are automated in the background and should not be changed. Those most relevant to generating ID of interest are</p>
<ul>
<li><code>chi</code>: the dimensionless spin parameter <code>~[-0.6, 0.6]</code></li>
<li><code>madm</code>: the total gravitational mass is a fixing parameter iff the <code>mb_fixing</code> control is set to off</li>
<li><code>res</code>: the final resolution used in each numerical domain (this will be discussed more below)</li>
</ul>
<h2><a class="anchor" id="autotoc_md92"></a>
EOS Parameters</h2>
<ul>
<li><code>eosfile</code>: The EOS file containing the cold table or piecewise polytrope to be used</li>
<li><code>eostype</code>: specify the use of a cold table <code>Cold_Table</code> or a piecewise polytrope <code>Cold_PWPoly</code></li>
<li><code>h_cut</code>: (optional) in the event one wants to cut the cold table at a certain specific enthalpy value (default: 0)</li>
<li><code>interpolation_pts</code>: (optional) number of points to use in order to interpolate a cold table (default: 2000). Not relevant for <code>Cold_PWPoly</code></li>
</ul>
<p>For example, if one wanted to change from the default EOS to a <code>Gamma = 2</code> polytrope, they would set in the config file</p>
<ul>
<li><code>eosfile gam2.polytrope</code></li>
<li><code>eostype Cold_PWPoly</code></li>
</ul>
<p>The other parameters can be ignored.</p>
<h2><a class="anchor" id="autotoc_md93"></a>
Fields</h2>
<div class="fragment"><div class="line">fields</div>
<div class="line">{</div>
<div class="line">    conf on</div>
<div class="line">    lapse on</div>
<div class="line">    shift on</div>
<div class="line">    logh on</div>
<div class="line">}</div>
</div><!-- fragment --><p>Within the full Config or the output solutions, <code>Fields</code> documents the fields that are used in the solver and stored in the <code>dat</code> file. Changing this has no impact.</p>
<h2><a class="anchor" id="autotoc_md94"></a>
Stages</h2>
<div class="fragment"><div class="line">stages</div>
<div class="line">{</div>
<div class="line">    norot_bc on</div>
<div class="line">    total_bc on</div>
<div class="line">}</div>
</div><!-- fragment --><p>For the isolated NS, only the <code>NOROT_BC</code> and <code>TOTAL_BC</code> stages are relevant. These will be discussed in the sections below related to these stages. Old stages available in the original v1 solver are since deprecated.</p>
<h2><a class="anchor" id="autotoc_md95"></a>
Relevant Controls</h2>
<div class="fragment"><div class="line">sequence_controls</div>
<div class="line">{</div>
<div class="line">    checkpoint off</div>
<div class="line">    sequences on</div>
<div class="line">}</div>
</div><!-- fragment --><ul>
<li><code>checkpoint</code>: this will result in checkpoints being saved to file during each solving iteration - mainly helpful for high resolution binary ID</li>
<li><code>sequences</code>: this toggle is enabled by default and essentially tells the driver routine to start from scratch. If this is enabled when attempting to use a previous solution, the previous solution (i.e. the <code>dat</code> file) is ignored and the solver starts from the most basic initial guess</li>
<li><code>fixed_mb</code>: **(not fully tested)** toggling this control enables using fixed baryonic mass <code>mb</code> instead of fixing the gravitational mass <code>madm</code></li>
</ul>
<h2><a class="anchor" id="autotoc_md96"></a>
Sequence Settings</h2>
<div class="fragment"><div class="line">sequence_settings</div>
<div class="line">{</div>
<div class="line">    solver_max_iterations 15</div>
<div class="line">    solver_precision 1e-08</div>
<div class="line">    initial_resolution 9</div>
<div class="line">}</div>
</div><!-- fragment --><ul>
<li><code>solver_max_iterations</code>: set the number of iterations not to exceed</li>
<li><code>solver_precision</code>: Determines what is the maximum precision allowed by the solver that determines whether or not the solution has converged</li>
<li><code>initial_resolution</code>: (optional) by default all solutions are ran at at a default resolution of <code>[9,9,8]</code> prior to regridding to a higher resolution. In the event one wants to increase the default <code>initial_resolution</code>, it can be done here</li>
</ul>
<h1><a class="anchor" id="autotoc_md97"></a>
6. Your Second run!</h1>
<p>Now that you've generated the simplest case and we have a better understanding of the config file, we can try something more interesting</p>
<ol type="1">
<li>Open the initial config file in your favorite editor</li>
<li>Set<ul>
<li><code>madm 2.3</code></li>
<li><code>chi 0.6</code></li>
<li><code>res 11</code></li>
</ul>
</li>
<li>Run (using parallelization) using this config file, e.g. <code>mpirun ./bin/Release/solve initial_ns.info</code></li>
</ol>
<p>Many things will run differently this time! Most notably are the following:</p>
<ol type="1">
<li>Even though the resolution was set to <code>res 11</code>, the initial solution is always constructed using <code>initial_resolution</code> first. Currently the default initial resolution is <code>res 9</code>.</li>
<li>For rotating solutions, two automated procedures are in place to ensure convergence<ol type="a">
<li>Iterative mass increase: in the event the desired mass is above Mtov<ul>
<li>the initial spinning solution is obtained using Mtov</li>
<li>once the desired spin is obtained at Mtov, the mass is increased to the desired value and the <code>TOTAL_BC</code> stage is reran</li>
</ul>
</li>
<li>Iterative spin increase: the system of equations is sensitive to large changes in the spin, therefore, an automated iterative procedure is done to maximize the chance for convergence by solving for <pre class="fragment">    1. `chi = 0.1`
    2. `chi = 0.6`
</pre></li>
</ol>
</li>
<li>Once the desired <code>chi</code> and <code>madm</code> is achieved, the solution is interpolated onto a new numerical grid with the desired final resolution</li>
<li>With the high resolution initial guess, the <code>TOTAL_BC</code> stage is reran to obtain the desired ID</li>
<li>This results in the converged dataset of <code>NS_TOTAL_BC.togashi.2.3.0.6.0.0.11.info/dat</code>, however, the other implicit solutions have been saved as well.</li>
</ol>
<p>We can of course verify that the ID matches our expectation using</p>
<p><code>./bin/Release/reader NS_TOTAL_BC.togashi.2.3.0.6.0.11.info</code></p>
<div class="fragment"><div class="line">                   RES = [+11,+11,+10]</div>
<div class="line">            Coord R_IN = +1.47139</div>
<div class="line">               Coord R = [+2.94504, +3.97120]</div>
<div class="line">           Coord R_OUT = +5.95079</div>
<div class="line"> </div>
<div class="line">               Areal R = +6.25539 [+9.23921km]</div>
<div class="line">         Baryonic Mass = +2.65411</div>
<div class="line">              ADM Mass = +2.30000 [+2.30000]</div>
<div class="line">          ADM Momentum = +3.17400</div>
<div class="line">                   Chi = +0.60000 [+0.60000]</div>
<div class="line">                 Omega = +0.06396</div>
<div class="line">       Central Density = +4.56602e-03</div>
<div class="line">        Central log(h) = +1.46938e+00</div>
<div class="line">      Central Pressure = +1.02698e-02</div>
<div class="line">    Central dlog(h)/dx = +6.70501e-14</div>
<div class="line">Central Euler Constant = -7.39008e-01</div>
<div class="line">     Integrated log(h) = +583.85557</div>
<div class="line"> </div>
<div class="line">                    Mk = +2.29825, Diff: +7.63310e-04</div>
<div class="line">                    Px = +0.00000</div>
<div class="line">                    Py = +0.00000</div>
<div class="line">                    Pz = +0.00000</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md98"></a>
7. How NS ID is Generated</h1>
<h2><a class="anchor" id="autotoc_md99"></a>
Initial Setup</h2>
<p>In initial data generation, the initial setup is the most crucial. When starting the NS solver from scratch, we need to determine an initial guess and what better way than a 1D TOV solution! In this way, a root finder is attempted for the input ADM mass for the specific EOS. Either a solution is found for your input mass (i.e. the input mass is less than the maximum non-rotating TOV mass, Mtov) or the maximum mass is used as the initial guess for the non-rotating solution. <br  />
 In the event an <code>madm</code> above Mtov is used with no spin, an error is given.</p>
<p>Once the 1D TOV solution is obtained, this solution is then interpolated onto the scalar fields associated with the low resolution 3D numerical grid.</p>
<h2><a class="anchor" id="autotoc_md100"></a>
NOROT_BC Stage</h2>
<p>Now that the initial setup is complete, the first stage to run is the non-rotating stage. In this stage, all equations related to the shift are not taken into account while the fluid and space-time are able to find an equilibrium solution.</p>
<h2><a class="anchor" id="autotoc_md101"></a>
TOTAL_BC Stage</h2>
<p>With a stable solution to start from, a rotating solution is now found based on the <code>chi</code> fixing parameter.</p>
<h3><a class="anchor" id="autotoc_md102"></a>
Automated iterative spin</h3>
<p>For highly spinning NS configurations it has been found to be most reliable to obtain a slowly spinning solution prior to a highly spinning one. Therefore, an initial spin of <code>chi = +/- 0.1</code> is used before attempting higher spins.</p>
<h3><a class="anchor" id="autotoc_md103"></a>
Automated iterative mass</h3>
<p>In the event the desired mass is above Mtov, the initial solution is constructed up to the desired <code>chi</code> using Mtov. Once this solution has been obtained, the ADM mass is updated to the desired ADM mass and only the <code>TOTAL_BC</code> stage is reran</p>
<h3><a class="anchor" id="autotoc_md104"></a>
Automated resolution increase</h3>
<p>Once the above procedures are completed for the last stage and the input <code>res</code> is higher than the <code>initial_resolution</code>, the low resolution solution is interpolated onto the higher resolution numerical grid and is used as the initial guess before running the last stage again. No additional iterative procedures are required at this point. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
